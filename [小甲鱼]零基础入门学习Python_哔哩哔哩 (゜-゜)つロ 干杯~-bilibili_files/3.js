webpackJsonpwebpackReporter([3],{15:function(r,t,o){"use strict";function e(r){return r&&r.__esModule?r:{"default":r}}function i(r,t){if(!(r instanceof t))try{throw new TypeError("Cannot call a class as a function")}catch(e){}}t.__esModule=!0;var n=o(1),s=e(n),a=function(){function r(t){i(this,r),this.win=t,this.scriptErrorLimit=5,this.scriptErrorCount=0,this.imgErrorLimit=5,this.imgErrorCount=0,this.ERROR_RUNTIME=1,this.ERROR_SCRIPT=2,this.ERROR_STYLE=3,this.ERROR_IMAGE=4,this.ERROR_AUDIO=5,this.ERROR_VIDEO=6,this.ERROR_CONSOLE=7,this.ERROR_TRY_CATHC=8,this.LOAD_ERROR_TYPE={SCRIPT:this.ERROR_SCRIPT,LINK:this.ERROR_STYLE,IMG:this.ERROR_IMAGE,AUDIO:this.ERROR_AUDIO,VIDEO:this.ERROR_VIDEO},this.doCollectorWinError(),this.doCollectorResourceError()}return r.prototype.setIgnoredPattern=function(){for(var r=arguments.length,t=Array(r),o=0;o<r;o++)t[o]=arguments[o];this.ignoredPatterns=t.map(function(r){return new RegExp(r)})},r.prototype.todo=function(r,t,o){var e={time:(new Date).toISOString(),level:"ERROR",app_id:"main.frontend.bilibili-log-report-seed",instance_id:r,errorType:t,userAgent:navigator.userAgent,url:document.baseURI||window.location.href,referrer:document.referrer};if(o instanceof Object)for(var i in o)e[i]=o[i];else e.errorMsg=o;if(this.ignoredPatterns&&e.errorMsg)for(var n=0;n<this.ignoredPatterns.length;n++)if(this.ignoredPatterns[n].test(e.errorMsg))return;if(4===t){if(this.imgErrorCount>=this.imgErrorLimit)return;this.imgErrorCount++}var a={msg:JSON.stringify(e)},R={type:"errorLog",obj:a};s["default"].receiveGroupMsg(R)},r.prototype.tryCatchError=function(r){this.todo("trycatch",this.ERROR_TRY_CATHC,r)},r.prototype.formatLoadError=function(r){return{url:r.baseURI||document.baseURI||window.location.href,errorMsg:r.outerHTML||r.href}},r.prototype.doCollectorResourceError=function(){var r=this;window.addEventListener("error",function(t){var o=t.target;if(o!==window&&o.nodeName&&r.LOAD_ERROR_TYPE[o.nodeName.toUpperCase()]){var e=r.LOAD_ERROR_TYPE[o.nodeName.toUpperCase()];(4!==e||o.getAttribute("src"))&&r.todo("resource",e,r.formatLoadError(o))}},!0)},r.prototype.doCollectorWinError=function(){var r;"function"==typeof this.win.onerror&&(r=this.win.onerror);var t=this;window.onerror=function(o,e,i,n,s){return r&&r.apply(this.win,arguments),e?"Script error."===o||"Script error"===o?(setTimeout(function(){var r={};r.url=e,r.pageUrl=window.location.href||document.baseURI,r.errorMsg="Script error.",t.scriptErrorCount<t.scriptErrorLimit&&(t.scriptErrorCount++,t.todo("runtime",1,r))},0),!1):(setTimeout(function(){var r={};n=n||window.event&&window.event.errorCharacter||0,r.url=e,r.pageUrl=window.location.href||document.baseURI,r.line=i,r.col=n,r.errorMsg=o,s&&s.stack&&(r.errorMsg=s.stack.toString()),t.todo("runtime",1,r)},0),!1):(setTimeout(function(){var r={};r.url=document.baseURI,r.errorMsg=o,"Script error."===o||"Script error"===o?t.scriptErrorCount<t.scriptErrorLimit&&(t.scriptErrorCount++,t.todo("runtime",1,r)):t.todo("runtime",1,r)},0),!1)}},r}();t["default"]=a}});